<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Login</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f4f7fa;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0; /* Ajout pour éviter les barres de défilement inutiles */
        }

        .login-container {
            background: white;
            padding: 2rem 3rem;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 400px;
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 1.5rem;
        }

        .alert {
            padding: 0.75rem;
            border-radius: 6px;
            margin-bottom: 1rem;
            font-size: 0.95rem;
        }

        .alert-danger {
            background-color: #f8d7da;
            color: #721c24;
        }

        .alert-success {
            background-color: #d4edda;
            color: #155724;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            color: #555;
        }

        input {
            width: 100%; /* Utilise box-sizing pour inclure padding/border dans la largeur */
            box-sizing: border-box;
            padding: 0.5rem;
            margin-bottom: 1rem;
            border: 1px solid #ccc;
            border-radius: 6px;
            font-size: 1rem;
        }

        button {
            width: 100%;
            padding: 0.75rem;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            cursor: pointer;
        }

        button:hover {
            background-color: #0056b3;
        }

        p {
            text-align: center;
            margin-top: 1rem;
        }

        a {
            color: #007bff;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        .language-selector {
            position: absolute;
            top: 10px;
            right: 10px;
        }
    </style>
</head>
<body>
    <div class="language-selector">
        <select id="langSelect" class="form-select" style="width: 150px; display: inline-block;">
            <option value="en" selected>English</option>
            <option value="fr">Français</option>
            <option value="es">Español</option>
        </select>
    </div>

    <div class="login-container">
        <h1>Log In</h1>

        <div th:if="${param.error}" class="alert alert-danger">
            Invalid email or password.
        </div>

        <div th:if="${param.logout}" class="alert alert-success">
            You have logged out.
        </div>

        <div th:if="${param.success}" class="alert alert-success">
            Registration successful.
        </div>

        <form th:action="@{/login}" method="post">
            <div>
                <label for="email">Email:</label>
                <input type="email" id="email" name="email" required />
            </div>
            <div>
                <label for="password">Password:</label>
                <input type="password" id="password" name="password" required />
            </div>
            <button type="submit">Log in</button>
        </form>

        <p>Don't have an account? <a th:href="@{/register}">Register</a></p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const langSelect = document.getElementById('langSelect');

            const translations = {
                en: {
                    loginTitle: "Log In",
                    emailLabel: "Email:",
                    passwordLabel: "Password:",
                    loginButton: "Log in",
                    registerText: "Don't have an account?", // Texte avant le lien
                    registerLink: "Register",             // Texte du lien
                    errorMsg: "Invalid email or password.",
                    logoutMsg: "You have logged out.",
                    successMsg: "Registration successful."
                },
                fr: {
                    loginTitle: "Se Connecter",
                    emailLabel: "E-mail:",
                    passwordLabel: "Mot de passe:",
                    loginButton: "Se Connecter",
                    registerText: "Vous n'avez pas de compte?",
                    registerLink: "S'inscrire",
                    errorMsg: "E-mail ou mot de passe invalide.",
                    logoutMsg: "Vous vous êtes déconnecté.",
                    successMsg: "Inscription réussie."
                },
                es: {
                    loginTitle: "Iniciar sesión",
                    emailLabel: "Correo electrónico:",
                    passwordLabel: "Contraseña:",
                    loginButton: "Iniciar sesión",
                    registerText: "¿No tienes cuenta?",
                    registerLink: "Registrarse",
                    errorMsg: "Correo electrónico o contraseña incorrectos.",
                    logoutMsg: "Has cerrado sesión.",
                    successMsg: "Registro exitoso."
                }
            };

            langSelect.addEventListener('change', function() {
                updateTexts(this.value);
            });

            function updateTexts(lang) {
                const t = translations[lang];
                document.querySelector('h1').textContent = t.loginTitle;
                document.querySelector('label[for="email"]').textContent = t.emailLabel;
                document.querySelector('label[for="password"]').textContent = t.passwordLabel;
                document.querySelector('button[type="submit"]').textContent = t.loginButton;

                const registerParagraph = document.querySelector('.login-container p');
                if (registerParagraph) {
                    const registerLinkElement = registerParagraph.querySelector('a');
                    if (registerLinkElement) {
                        registerLinkElement.textContent = t.registerLink;

                        if (registerParagraph.firstChild && registerParagraph.firstChild.nodeType === Node.TEXT_NODE) {
                            registerParagraph.firstChild.nodeValue = t.registerText + " ";
                        }
                    }
                }

                const errorAlert = document.querySelector('div[th\\:if="${param.error}"].alert-danger');
                if (errorAlert) {
                    errorAlert.textContent = t.errorMsg;
                }

                const logoutAlert = document.querySelector('div[th\\:if="${param.logout}"].alert-success');
                if (logoutAlert) {
                    logoutAlert.textContent = t.logoutMsg;
                }

                const registrationSuccessAlert = document.querySelector('div[th\\:if="${param.success}"].alert-success');
                if (registrationSuccessAlert) {
                    registrationSuccessAlert.textContent = t.successMsg;
                }
            }

        });
    </script>
</body>
</html>