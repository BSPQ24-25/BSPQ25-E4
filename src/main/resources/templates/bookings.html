<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöó Booking List</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f8ff;
            text-align: center;
        }
        h1 {
            color: #4caf50;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }
        table {
            width: 90%;
            margin: 20px auto;
            border-collapse: collapse;
            background-color: white;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }
        th, td {
            padding: 12px;
            text-align: center;
        }
        th {
            background-color: #4caf50;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        tr:hover {
            background-color: #ffcccb;
            transition: 0.3s;
        }
        td {
            font-size: 14px;
        }

        /* Language selection style */
        .lang-selector {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 1000;
        }

        .lang-selector select {
            padding: 5px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <h1>üöó Booking List</h1>
    
    <!-- Language Selector -->
    <div class="lang-selector">
        <select id="langSelect">
            <option value="en" selected>English</option>
            <option value="es">Espa√±ol</option>
            <option value="fr">Fran√ßais</option>
        </select>
    </div>

    <table>
        <thead>
            <tr>
                <th id="idColumn">ID</th>
                <th id="priceColumn">üí∞ Daily Price</th>
                <th id="startDateColumn">üìÖ Start Date</th>
                <th id="endDateColumn">üìÖ End Date</th>
                <th id="statusColumn">üìå Status</th>
                <th id="paymentColumn">üí≥ Payment</th>
                <th id="depositColumn">üîí Security Deposit</th>
                <th id="userColumn">üë§ User</th>
                <th id="vehicleColumn">üöò Vehicle</th>
                <th id="ratingColumn">‚≠ê Rating</th>
                <th id="reviewColumn">üí¨ Review</th>
                <th id="cancelColumn">‚ùå Cancel</th> <!-- New column for cancel button -->
            </tr>
        </thead>
        <tbody id="bookingsTableBody">
            <!-- Bookings will be inserted here -->
        </tbody>
    </table>

    <script>
        const translations = {
            en: {
                title: "üöó Booking List",
                idColumn: "ID",
                priceColumn: "üí∞ Daily Price",
                startDateColumn: "üìÖ Start Date",
                endDateColumn: "üìÖ End Date",
                statusColumn: "üìå Status",
                paymentColumn: "üí≥ Payment",
                depositColumn: "üîí Security Deposit",
                userColumn: "üë§ User",
                vehicleColumn: "üöò Vehicle",
                ratingColumn: "‚≠ê Rating",
                reviewColumn: "üí¨ Review",
                cancelColumn: "‚ùå Cancel",
                cancelButton: "‚ùå Cancel",
                noReview: "No review"
            },
            fr: {
                title: "üöó Liste des R√©servations",
                idColumn: "ID",
                priceColumn: "üí∞ Prix Journalier",
                startDateColumn: "üìÖ Date de D√©but",
                endDateColumn: "üìÖ Date de Fin",
                statusColumn: "üìå Statut",
                paymentColumn: "üí≥ Paiement",
                depositColumn: "üîí D√©p√¥t de Garantie",
                userColumn: "üë§ Utilisateur",
                vehicleColumn: "üöò V√©hicule",
                ratingColumn: "‚≠ê Note",
                reviewColumn: "üí¨ Avis",
                cancelColumn: "‚ùå Annuler",
                cancelButton: "‚ùå Annuler",
                noReview: "Pas d'avis"
            },
            es: {
                title: "üöó Lista de Reservas",
                idColumn: "ID",
                priceColumn: "üí∞ Precio Diario",
                startDateColumn: "üìÖ Fecha de Inicio",
                endDateColumn: "üìÖ Fecha de Fin",
                statusColumn: "üìå Estado",
                paymentColumn: "üí≥ Pago",
                depositColumn: "üîí Dep√≥sito de Seguridad",
                userColumn: "üë§ Usuario",
                vehicleColumn: "üöò Veh√≠culo",
                ratingColumn: "‚≠ê Calificaci√≥n",
                reviewColumn: "üí¨ Rese√±a",
                cancelColumn: "‚ùå Cancelar",
                cancelButton: "‚ùå Cancelar",
                noReview: "Sin rese√±a"
            }
        };

        document.addEventListener('DOMContentLoaded', fetchBookings);

        document.getElementById('langSelect').addEventListener('change', (e) => {
            updateTexts(e.target.value);
        });

        async function fetchBookings() {
            try {
                const response = await fetch('/api/bookings'); // Modify the URL if needed
                const bookings = await response.json();
                
                const tableBody = document.getElementById('bookingsTableBody');
                tableBody.innerHTML = '';

                bookings.forEach(booking => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${booking.bookingId}</td>
                        <td>üí∞ ${booking.dailyPrice.toFixed(2)} ‚Ç¨</td>
                        <td>üìÖ ${booking.startDate}</td>
                        <td>üìÖ ${booking.endDate}</td>
                        <td>üìå ${booking.bookingStatus}</td>
                        <td>üí≥ ${booking.paymentMethod}</td>
                        <td>üîí ${booking.securityDeposit.toFixed(2)} ‚Ç¨</td>
                        <td>üë§ ${booking.user ? booking.user.name : 'N/A'}</td>
                        <td>üöò ${booking.car ? booking.car.model : 'N/A'}</td>
                        <td>‚≠ê ${booking.rating || 'N/A'}</td>
                        <td>üí¨ ${booking.review || translations[document.documentElement.lang].noReview}</td>
                        <td><button onclick="cancelBooking(${booking.bookingId})">${translations[document.documentElement.lang].cancelButton}</button></td> <!-- Cancel button -->
                    `;
                    tableBody.appendChild(row);
                });
            } catch (error) {
                console.error('Error fetching bookings:', error);
            }
        }

        async function cancelBooking(bookingId) {
            try {
                const response = await fetch(`/api/bookings/${bookingId}`, {
                    method: 'DELETE',
                });

                if (response.ok) {
                    alert('Booking cancelled successfully');
                    fetchBookings(); // Refresh the booking list
                } else {
                    alert('Error cancelling booking');
                }
            } catch (error) {
                console.error('Error cancelling booking:', error);
            }
        }

        function updateTexts(lang) {
            const t = translations[lang];
            document.querySelector('h1').textContent = t.title;
            document.querySelectorAll('th')[0].textContent = t.idColumn;
            document.querySelectorAll('th')[1].textContent = t.priceColumn;
            document.querySelectorAll('th')[2].textContent = t.startDateColumn;
            document.querySelectorAll('th')[3].textContent = t.endDateColumn;
            document.querySelectorAll('th')[4].textContent = t.statusColumn;
            document.querySelectorAll('th')[5].textContent = t.paymentColumn;
            document.querySelectorAll('th')[6].textContent = t.depositColumn;
            document.querySelectorAll('th')[7].textContent = t.userColumn;
            document.querySelectorAll('th')[8].textContent = t.vehicleColumn;
            document.querySelectorAll('th')[9].textContent = t.ratingColumn;
            document.querySelectorAll('th')[10].textContent = t.reviewColumn;
            document.querySelectorAll('th')[11].textContent = t.cancelColumn;
        }
    </script>
</body>
</html>
